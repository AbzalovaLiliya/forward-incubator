## Описание таблиц

### fw_contracts
| Столбец | Описание |
| --- | --- |
|ID_CONTRACT_INST|Идентификатор контракта|
|DT_STOP|Дата конца действия записи|
|DT_START|Дата начала действия записи|
|ID_REC|Идентификатор записи|
|ID_CLIENT_INST|Идентификатор клиента|
|ID_CURRENCY|Валюта контракта|
|V_STATUS|Статус А активен,B заблокирован,С расторжен,D удален|
|DT_REG_EVENT|Дата регистрации|
|V_DESCRIPTION|Описание контракта|
|ID_DEPARTMENT|Код департамента из миграционной таблицы MIGR_DEPARTMENTS|
|ID_CATEGORY|Код котегории контракта|
|V_EXT_IDENT|Внешний идентификатор контракта|

### scd_signers
| Столбец | Описание |
| --- | --- |
|V_FIO|Имя подписанта|
|ID_MANAGER|Код пользователя подписанта|

### fw_clients
| Столбец | Описание |
| --- | --- |
|ID_REC|Уникальный код записи в рамках всей системы|
|ID_CLIENT_INST|Идентификатор клиента|
|DT_STOP|Дата конца действия записи|
|DT_START|Дата начала действия записи|
|V_LONG_TITLE|Полное наименование клиента|

### ci_users
| Столбец | Описание |
| --- | --- |
|ID_USER|Код пользователя|
|V_USERNAME|Логин|
|V_DESCRIPTION|Описание пользователя (Ф.И.О.)|
|V_STATUS|Статус|
|DT_CREATED|Дата создания пользователя|
|DT_MODIFIED|Дата последнего изменения данных пользователя|
|V_STATUS|Статус|
|ID_CLIENT_INST|Идентификатор клиента|

### scd_equip_kits
| Столбец | Описание |
| --- | --- |
|id_equip_kits_inst|Идентификатор|
|id_equip_kits_type|Тип комплекта|
|v_ext_ident|Серийный номер|
|dt_stop|Дата конца действия записи|
|dt_start|Дата начала действия записи|
|id_rec|Уникальный код записи в рамках всей системы|
|id_status|Статус|
|id_contract_inst|Контракт|
|id_dealer_client|Клиент дилера, к которому привязан комплект|
|v_cas_id|cas id|

### scd_contracts
| Столбец | Описание |
| --- | --- |
|id_contract_inst|Контракт|
|b_agency|Признак отношения к агентской сети. 1 - является агентской сетью, 0 - не является агентской сетью|

### scd_equipment_status
| Столбец | Описание |
| --- | --- |
|id_equipment_status|Идентификатор|
|v_name|Наименование|
|v_descr|Описание|
|b_deleted|Признак удаления|
|v_ext_ident|Внешний идентификатор|

### scd_equipment_kits_type
| Столбец | Описание |
| --- | --- |
|id_equip_kits_type|Первичный ключ|
|v_name|Наименование комплекта|
|dt_stop|Дата конца действия записи|
|dt_start|Дата начала действия записи|
|id_rec|Уникальный код записи в рамках всей системы|



## Задачи


1) Реализовать процедуру saveSigners, принимающую на вход ФИО подписанта(pV_FIO), код пользователя(pID_MANAGER) и действие(pACTION). В процедуре:
а) Реализовать проверку существования в таблице ci_users строчки с кодом пользователя(ci_users.id_user = pID_MANAGER). 
В случае, если пользователь не найден, выдать ошибку (команда raise_application_error, код ошибки -20020) "Пользователь не найден".
Рекомендация - либо использовать count и if, либо обработку ошибок begin ... exception when no_data found ... end;
б) В зависимости от действия pACTION:
если pACTION = 1, тогда реализовать добавление в таблицу scd_signers строчки (pV_FIO, pID_MANAGER). В случае, если запись с данным id_manager уже присутствует, выдать ошибку.
если pACTION = 2, тогда реализовать редактирование в таблице scd_signers параметра V_FIO строчки с данным id_manager.
если pACTION = 3, реализовать удаление строки с данным id_manager.
Рекомендация - использовать команду case.
2) Реализовать функцию getDecoder, принимающую на вход id_equip_kits_inst. В случае, если в scd_equip_kits у актуальной записи проставлен контракт,
 у которого в scd_contracts проставлен признак b_agency = 1, тогда вернуть scd_equip_kits.v_cas_id,
 иначе scd_equip_kits.v_ext_ident.
 Если оборудование не найдено, то выдать ошибку "Оборудование не найдено".
3) Реализовать процедуру getEquip, принимающую на вход pID_EQUIP_KITS_INST default null и отдающую(out) sys_refcursor.
В процедуре с помощью конструкции OPEN...FOR реализовать наполнение курсора следующими данными:
Наименование клиента, логин клиента, идентификатор контракта, наименование комплекта, номер декодера(использовать функцию getDecoder).
В случае, если pID_EQUIP_KITS_INST is null, тогда все имеющиеся данные, иначе только строчку с данным pID_EQUIP_KITS_INST.
Каждому scd_equip_kits.id_equip_kits_inst соответствует одна строчка курсора.
4) Реализовать с помощью цикла по курсору процедуру checkstatus.
Процедура должна для записей, у которых scd_equip_kits.id_dealer_client не null, но статус отличный от Продано(scd_equipment_status) проставить статус Продано. Кроме того,
вывести в dbms_output.put_line информацию в виде: "Для оборудования scd_equip_kits.id_equip_kits_inst дилера fw_clients.v_long_tittle с контрактом fw_contracts.v_ext_ident,
являющегося(если scd_contracts.b_agency = 1)/неявляющегося(если scd_contracts.b_agency = 0) агентской сетью был проставлен статус Продано."
 